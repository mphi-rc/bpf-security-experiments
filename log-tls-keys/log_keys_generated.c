#include <linux/bpf.h>
#include <linux/bpf_common.h>
#include <stdlib.h>

#define BPF_INSN(OPCODE, DESTINATION, SOURCE, OFFSET, IMMEDIATE) \
  ((struct bpf_insn){.code = OPCODE,                             \
                     .dst_reg = DESTINATION,                     \
                     .src_reg = SOURCE,                          \
                     .off = OFFSET,                              \
                     .imm = IMMEDIATE})

union bpf_attr* prog_tracepoint_save_pkey_addr(int fd_pkey_addr_by_tid,
                                               char* license, char* log_buf,
                                               int log_buf_size,
                                               int log_level) {
  struct bpf_insn* program = calloc(14, sizeof(struct bpf_insn));
  program[0] = BPF_INSN(0x79, 1, 1, 104, 0);
  program[1] = BPF_INSN(0x7b, 10, 1, -8, 0);
  program[2] = BPF_INSN(0x85, 0, 0, 0, 14);
  program[3] = BPF_INSN(0x7b, 10, 0, -16, 0);
  program[4] = BPF_INSN(0xbf, 2, 10, 0, 0);
  program[5] = BPF_INSN(0x07, 2, 0, 0, -16);
  program[6] = BPF_INSN(0xbf, 3, 10, 0, 0);
  program[7] = BPF_INSN(0x07, 3, 0, 0, -8);
  program[8] = BPF_INSN(0x18, 1, 1, 0, fd_pkey_addr_by_tid);
  program[9] = BPF_INSN(0x00, 0, 0, 0, 0);
  program[10] = BPF_INSN(0xb7, 4, 0, 0, 0);
  program[11] = BPF_INSN(0x85, 0, 0, 0, 2);
  program[12] = BPF_INSN(0xb7, 0, 0, 0, 0);
  program[13] = BPF_INSN(0x95, 0, 0, 0, 0);
  union bpf_attr* ret = calloc(1, sizeof(union bpf_attr));
  ret->prog_type = BPF_PROG_TYPE_KPROBE;
  ret->insns = (unsigned long)program;
  ret->insn_cnt = 14;
  ret->log_buf = (unsigned long)log_buf;
  ret->log_size = log_buf_size;
  ret->log_level = log_level;
  ret->license = (unsigned long)license;
  return ret;
}
union bpf_attr* prog_tracepoint_read_pkey(int fd_pkey_addr_by_tid,
                                          char* license, char* log_buf,
                                          int log_buf_size, int log_level) {
  struct bpf_insn* program = calloc(390, sizeof(struct bpf_insn));
  program[0] = BPF_INSN(0x85, 0, 0, 0, 14);
  program[1] = BPF_INSN(0x7b, 10, 0, -8, 0);
  program[2] = BPF_INSN(0xbf, 2, 10, 0, 0);
  program[3] = BPF_INSN(0x07, 2, 0, 0, -8);
  program[4] = BPF_INSN(0x18, 1, 1, 0, fd_pkey_addr_by_tid);
  program[5] = BPF_INSN(0x00, 0, 0, 0, 0);
  program[6] = BPF_INSN(0x85, 0, 0, 0, 1);
  program[7] = BPF_INSN(0xbf, 6, 0, 0, 0);
  program[8] = BPF_INSN(0x15, 6, 0, 379, 0);
  program[9] = BPF_INSN(0xbf, 2, 10, 0, 0);
  program[10] = BPF_INSN(0x07, 2, 0, 0, -8);
  program[11] = BPF_INSN(0x18, 1, 1, 0, fd_pkey_addr_by_tid);
  program[12] = BPF_INSN(0x00, 0, 0, 0, 0);
  program[13] = BPF_INSN(0x85, 0, 0, 0, 3);
  program[14] = BPF_INSN(0x79, 3, 6, 0, 0);
  program[15] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[16] = BPF_INSN(0x07, 1, 0, 0, -16);
  program[17] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[18] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[19] = BPF_INSN(0x79, 3, 10, -16, 0);
  program[20] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[21] = BPF_INSN(0x07, 1, 0, 0, -20);
  program[22] = BPF_INSN(0xb7, 2, 0, 0, 4);
  program[23] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[24] = BPF_INSN(0x61, 1, 10, -20, 0);
  program[25] = BPF_INSN(0x55, 1, 0, 362, 1034);
  program[26] = BPF_INSN(0x79, 3, 10, -16, 0);
  program[27] = BPF_INSN(0x07, 3, 0, 0, 40);
  program[28] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[29] = BPF_INSN(0x07, 1, 0, 0, -32);
  program[30] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[31] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[32] = BPF_INSN(0x79, 3, 10, -32, 0);
  program[33] = BPF_INSN(0xbf, 6, 10, 0, 0);
  program[34] = BPF_INSN(0x07, 6, 0, 0, -40);
  program[35] = BPF_INSN(0xbf, 1, 6, 0, 0);
  program[36] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[37] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[38] = BPF_INSN(0x79, 1, 10, -40, 0);
  program[39] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[40] = BPF_INSN(0x67, 2, 0, 0, 8);
  program[41] = BPF_INSN(0x57, 2, 0, 0, 16711680);
  program[42] = BPF_INSN(0xbf, 4, 1, 0, 0);
  program[43] = BPF_INSN(0x67, 4, 0, 0, 24);
  program[44] = BPF_INSN(0x67, 4, 0, 0, 32);
  program[45] = BPF_INSN(0x77, 4, 0, 0, 32);
  program[46] = BPF_INSN(0x4f, 4, 2, 0, 0);
  program[47] = BPF_INSN(0x18, 2, 0, 0, 1970282553);
  program[48] = BPF_INSN(0x00, 0, 0, 0, 976232546);
  program[49] = BPF_INSN(0x7b, 10, 2, -56, 0);
  program[50] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[51] = BPF_INSN(0x77, 2, 0, 0, 8);
  program[52] = BPF_INSN(0xbf, 3, 2, 0, 0);
  program[53] = BPF_INSN(0x57, 3, 0, 0, 65280);
  program[54] = BPF_INSN(0x4f, 4, 3, 0, 0);
  program[55] = BPF_INSN(0xbf, 5, 1, 0, 0);
  program[56] = BPF_INSN(0x77, 5, 0, 0, 40);
  program[57] = BPF_INSN(0x57, 5, 0, 0, 65280);
  program[58] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[59] = BPF_INSN(0x77, 3, 0, 0, 56);
  program[60] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[61] = BPF_INSN(0x77, 1, 0, 0, 24);
  program[62] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[63] = BPF_INSN(0x57, 3, 0, 0, 16711680);
  program[64] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[65] = BPF_INSN(0x18, 7, 0, 0, -16777216);
  program[66] = BPF_INSN(0x00, 0, 0, 0, 0);
  program[67] = BPF_INSN(0x5f, 2, 7, 0, 0);
  program[68] = BPF_INSN(0x4f, 5, 2, 0, 0);
  program[69] = BPF_INSN(0x57, 1, 0, 0, 255);
  program[70] = BPF_INSN(0x4f, 4, 1, 0, 0);
  program[71] = BPF_INSN(0x18, 9, 0, 0, 544744736);
  program[72] = BPF_INSN(0x00, 0, 0, 0, 686117);
  program[73] = BPF_INSN(0x7b, 10, 9, -48, 0);
  program[74] = BPF_INSN(0x18, 8, 0, 0, 1478522149);
  program[75] = BPF_INSN(0x00, 0, 0, 0, 825570610);
  program[76] = BPF_INSN(0x7b, 10, 8, -64, 0);
  program[77] = BPF_INSN(0x79, 3, 10, -8, 0);
  program[78] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[79] = BPF_INSN(0x07, 1, 0, 0, -64);
  program[80] = BPF_INSN(0xb7, 2, 0, 0, 24);
  program[81] = BPF_INSN(0x85, 0, 0, 0, 6);
  program[82] = BPF_INSN(0x79, 3, 10, -32, 0);
  program[83] = BPF_INSN(0x07, 3, 0, 0, 8);
  program[84] = BPF_INSN(0xbf, 1, 6, 0, 0);
  program[85] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[86] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[87] = BPF_INSN(0x79, 1, 10, -40, 0);
  program[88] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[89] = BPF_INSN(0x67, 2, 0, 0, 8);
  program[90] = BPF_INSN(0x57, 2, 0, 0, 16711680);
  program[91] = BPF_INSN(0xbf, 4, 1, 0, 0);
  program[92] = BPF_INSN(0x67, 4, 0, 0, 24);
  program[93] = BPF_INSN(0x67, 4, 0, 0, 32);
  program[94] = BPF_INSN(0x77, 4, 0, 0, 32);
  program[95] = BPF_INSN(0x4f, 4, 2, 0, 0);
  program[96] = BPF_INSN(0x18, 2, 0, 0, 1970282553);
  program[97] = BPF_INSN(0x00, 0, 0, 0, 976298082);
  program[98] = BPF_INSN(0x7b, 10, 2, -56, 0);
  program[99] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[100] = BPF_INSN(0x77, 2, 0, 0, 8);
  program[101] = BPF_INSN(0xbf, 3, 2, 0, 0);
  program[102] = BPF_INSN(0x57, 3, 0, 0, 65280);
  program[103] = BPF_INSN(0x4f, 4, 3, 0, 0);
  program[104] = BPF_INSN(0xbf, 5, 1, 0, 0);
  program[105] = BPF_INSN(0x77, 5, 0, 0, 40);
  program[106] = BPF_INSN(0x57, 5, 0, 0, 65280);
  program[107] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[108] = BPF_INSN(0x77, 3, 0, 0, 56);
  program[109] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[110] = BPF_INSN(0x77, 1, 0, 0, 24);
  program[111] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[112] = BPF_INSN(0x57, 3, 0, 0, 16711680);
  program[113] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[114] = BPF_INSN(0x5f, 2, 7, 0, 0);
  program[115] = BPF_INSN(0x4f, 5, 2, 0, 0);
  program[116] = BPF_INSN(0x57, 1, 0, 0, 255);
  program[117] = BPF_INSN(0x4f, 4, 1, 0, 0);
  program[118] = BPF_INSN(0x7b, 10, 9, -48, 0);
  program[119] = BPF_INSN(0x7b, 10, 8, -64, 0);
  program[120] = BPF_INSN(0x79, 3, 10, -8, 0);
  program[121] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[122] = BPF_INSN(0x07, 1, 0, 0, -64);
  program[123] = BPF_INSN(0xb7, 2, 0, 0, 24);
  program[124] = BPF_INSN(0x85, 0, 0, 0, 6);
  program[125] = BPF_INSN(0x79, 3, 10, -32, 0);
  program[126] = BPF_INSN(0x07, 3, 0, 0, 16);
  program[127] = BPF_INSN(0xbf, 1, 6, 0, 0);
  program[128] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[129] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[130] = BPF_INSN(0x79, 1, 10, -40, 0);
  program[131] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[132] = BPF_INSN(0x67, 2, 0, 0, 8);
  program[133] = BPF_INSN(0x57, 2, 0, 0, 16711680);
  program[134] = BPF_INSN(0xbf, 4, 1, 0, 0);
  program[135] = BPF_INSN(0x67, 4, 0, 0, 24);
  program[136] = BPF_INSN(0x67, 4, 0, 0, 32);
  program[137] = BPF_INSN(0x77, 4, 0, 0, 32);
  program[138] = BPF_INSN(0x4f, 4, 2, 0, 0);
  program[139] = BPF_INSN(0x18, 2, 0, 0, 1970282553);
  program[140] = BPF_INSN(0x00, 0, 0, 0, 976363618);
  program[141] = BPF_INSN(0x7b, 10, 2, -56, 0);
  program[142] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[143] = BPF_INSN(0x77, 2, 0, 0, 8);
  program[144] = BPF_INSN(0xbf, 3, 2, 0, 0);
  program[145] = BPF_INSN(0x57, 3, 0, 0, 65280);
  program[146] = BPF_INSN(0x4f, 4, 3, 0, 0);
  program[147] = BPF_INSN(0xbf, 5, 1, 0, 0);
  program[148] = BPF_INSN(0x77, 5, 0, 0, 40);
  program[149] = BPF_INSN(0x57, 5, 0, 0, 65280);
  program[150] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[151] = BPF_INSN(0x77, 3, 0, 0, 56);
  program[152] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[153] = BPF_INSN(0x77, 1, 0, 0, 24);
  program[154] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[155] = BPF_INSN(0x57, 3, 0, 0, 16711680);
  program[156] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[157] = BPF_INSN(0x5f, 2, 7, 0, 0);
  program[158] = BPF_INSN(0x4f, 5, 2, 0, 0);
  program[159] = BPF_INSN(0x57, 1, 0, 0, 255);
  program[160] = BPF_INSN(0x4f, 4, 1, 0, 0);
  program[161] = BPF_INSN(0x7b, 10, 9, -48, 0);
  program[162] = BPF_INSN(0x7b, 10, 8, -64, 0);
  program[163] = BPF_INSN(0x79, 3, 10, -8, 0);
  program[164] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[165] = BPF_INSN(0x07, 1, 0, 0, -64);
  program[166] = BPF_INSN(0xb7, 2, 0, 0, 24);
  program[167] = BPF_INSN(0x85, 0, 0, 0, 6);
  program[168] = BPF_INSN(0x79, 3, 10, -32, 0);
  program[169] = BPF_INSN(0x07, 3, 0, 0, 24);
  program[170] = BPF_INSN(0xbf, 1, 6, 0, 0);
  program[171] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[172] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[173] = BPF_INSN(0x79, 1, 10, -40, 0);
  program[174] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[175] = BPF_INSN(0x67, 2, 0, 0, 8);
  program[176] = BPF_INSN(0x57, 2, 0, 0, 16711680);
  program[177] = BPF_INSN(0xbf, 4, 1, 0, 0);
  program[178] = BPF_INSN(0x67, 4, 0, 0, 24);
  program[179] = BPF_INSN(0x67, 4, 0, 0, 32);
  program[180] = BPF_INSN(0x77, 4, 0, 0, 32);
  program[181] = BPF_INSN(0x4f, 4, 2, 0, 0);
  program[182] = BPF_INSN(0x18, 2, 0, 0, 1970282553);
  program[183] = BPF_INSN(0x00, 0, 0, 0, 976429154);
  program[184] = BPF_INSN(0x7b, 10, 2, -56, 0);
  program[185] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[186] = BPF_INSN(0x77, 2, 0, 0, 8);
  program[187] = BPF_INSN(0xbf, 3, 2, 0, 0);
  program[188] = BPF_INSN(0x57, 3, 0, 0, 65280);
  program[189] = BPF_INSN(0x4f, 4, 3, 0, 0);
  program[190] = BPF_INSN(0xbf, 5, 1, 0, 0);
  program[191] = BPF_INSN(0x77, 5, 0, 0, 40);
  program[192] = BPF_INSN(0x57, 5, 0, 0, 65280);
  program[193] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[194] = BPF_INSN(0x77, 3, 0, 0, 56);
  program[195] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[196] = BPF_INSN(0x77, 1, 0, 0, 24);
  program[197] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[198] = BPF_INSN(0x57, 3, 0, 0, 16711680);
  program[199] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[200] = BPF_INSN(0x5f, 2, 7, 0, 0);
  program[201] = BPF_INSN(0x4f, 5, 2, 0, 0);
  program[202] = BPF_INSN(0x57, 1, 0, 0, 255);
  program[203] = BPF_INSN(0x4f, 4, 1, 0, 0);
  program[204] = BPF_INSN(0x7b, 10, 9, -48, 0);
  program[205] = BPF_INSN(0x7b, 10, 8, -64, 0);
  program[206] = BPF_INSN(0x79, 3, 10, -8, 0);
  program[207] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[208] = BPF_INSN(0x07, 1, 0, 0, -64);
  program[209] = BPF_INSN(0xb7, 2, 0, 0, 24);
  program[210] = BPF_INSN(0x85, 0, 0, 0, 6);
  program[211] = BPF_INSN(0x79, 3, 10, -32, 0);
  program[212] = BPF_INSN(0x07, 3, 0, 0, 64);
  program[213] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[214] = BPF_INSN(0x07, 1, 0, 0, -72);
  program[215] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[216] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[217] = BPF_INSN(0x79, 3, 10, -72, 0);
  program[218] = BPF_INSN(0xbf, 1, 6, 0, 0);
  program[219] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[220] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[221] = BPF_INSN(0x79, 1, 10, -40, 0);
  program[222] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[223] = BPF_INSN(0x67, 2, 0, 0, 8);
  program[224] = BPF_INSN(0x57, 2, 0, 0, 16711680);
  program[225] = BPF_INSN(0xbf, 4, 1, 0, 0);
  program[226] = BPF_INSN(0x67, 4, 0, 0, 24);
  program[227] = BPF_INSN(0x67, 4, 0, 0, 32);
  program[228] = BPF_INSN(0x77, 4, 0, 0, 32);
  program[229] = BPF_INSN(0x4f, 4, 2, 0, 0);
  program[230] = BPF_INSN(0x18, 2, 0, 0, 1919950905);
  program[231] = BPF_INSN(0x00, 0, 0, 0, 976232566);
  program[232] = BPF_INSN(0x7b, 10, 2, -56, 0);
  program[233] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[234] = BPF_INSN(0x77, 2, 0, 0, 8);
  program[235] = BPF_INSN(0xbf, 3, 2, 0, 0);
  program[236] = BPF_INSN(0x57, 3, 0, 0, 65280);
  program[237] = BPF_INSN(0x4f, 4, 3, 0, 0);
  program[238] = BPF_INSN(0xbf, 5, 1, 0, 0);
  program[239] = BPF_INSN(0x77, 5, 0, 0, 40);
  program[240] = BPF_INSN(0x57, 5, 0, 0, 65280);
  program[241] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[242] = BPF_INSN(0x77, 3, 0, 0, 56);
  program[243] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[244] = BPF_INSN(0x77, 1, 0, 0, 24);
  program[245] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[246] = BPF_INSN(0x57, 3, 0, 0, 16711680);
  program[247] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[248] = BPF_INSN(0x5f, 2, 7, 0, 0);
  program[249] = BPF_INSN(0x4f, 5, 2, 0, 0);
  program[250] = BPF_INSN(0x57, 1, 0, 0, 255);
  program[251] = BPF_INSN(0x4f, 4, 1, 0, 0);
  program[252] = BPF_INSN(0x7b, 10, 9, -48, 0);
  program[253] = BPF_INSN(0x7b, 10, 8, -64, 0);
  program[254] = BPF_INSN(0x79, 3, 10, -8, 0);
  program[255] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[256] = BPF_INSN(0x07, 1, 0, 0, -64);
  program[257] = BPF_INSN(0xb7, 2, 0, 0, 24);
  program[258] = BPF_INSN(0x85, 0, 0, 0, 6);
  program[259] = BPF_INSN(0x79, 3, 10, -72, 0);
  program[260] = BPF_INSN(0x07, 3, 0, 0, 8);
  program[261] = BPF_INSN(0xbf, 1, 6, 0, 0);
  program[262] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[263] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[264] = BPF_INSN(0x79, 1, 10, -40, 0);
  program[265] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[266] = BPF_INSN(0x67, 2, 0, 0, 8);
  program[267] = BPF_INSN(0x57, 2, 0, 0, 16711680);
  program[268] = BPF_INSN(0xbf, 4, 1, 0, 0);
  program[269] = BPF_INSN(0x67, 4, 0, 0, 24);
  program[270] = BPF_INSN(0x67, 4, 0, 0, 32);
  program[271] = BPF_INSN(0x77, 4, 0, 0, 32);
  program[272] = BPF_INSN(0x4f, 4, 2, 0, 0);
  program[273] = BPF_INSN(0x18, 2, 0, 0, 1919950905);
  program[274] = BPF_INSN(0x00, 0, 0, 0, 976298102);
  program[275] = BPF_INSN(0x7b, 10, 2, -56, 0);
  program[276] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[277] = BPF_INSN(0x77, 2, 0, 0, 8);
  program[278] = BPF_INSN(0xbf, 3, 2, 0, 0);
  program[279] = BPF_INSN(0x57, 3, 0, 0, 65280);
  program[280] = BPF_INSN(0x4f, 4, 3, 0, 0);
  program[281] = BPF_INSN(0xbf, 5, 1, 0, 0);
  program[282] = BPF_INSN(0x77, 5, 0, 0, 40);
  program[283] = BPF_INSN(0x57, 5, 0, 0, 65280);
  program[284] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[285] = BPF_INSN(0x77, 3, 0, 0, 56);
  program[286] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[287] = BPF_INSN(0x77, 1, 0, 0, 24);
  program[288] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[289] = BPF_INSN(0x57, 3, 0, 0, 16711680);
  program[290] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[291] = BPF_INSN(0x5f, 2, 7, 0, 0);
  program[292] = BPF_INSN(0x4f, 5, 2, 0, 0);
  program[293] = BPF_INSN(0x57, 1, 0, 0, 255);
  program[294] = BPF_INSN(0x4f, 4, 1, 0, 0);
  program[295] = BPF_INSN(0x7b, 10, 9, -48, 0);
  program[296] = BPF_INSN(0x7b, 10, 8, -64, 0);
  program[297] = BPF_INSN(0x79, 3, 10, -8, 0);
  program[298] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[299] = BPF_INSN(0x07, 1, 0, 0, -64);
  program[300] = BPF_INSN(0xb7, 2, 0, 0, 24);
  program[301] = BPF_INSN(0x85, 0, 0, 0, 6);
  program[302] = BPF_INSN(0x79, 3, 10, -72, 0);
  program[303] = BPF_INSN(0x07, 3, 0, 0, 16);
  program[304] = BPF_INSN(0xbf, 1, 6, 0, 0);
  program[305] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[306] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[307] = BPF_INSN(0x79, 1, 10, -40, 0);
  program[308] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[309] = BPF_INSN(0x67, 2, 0, 0, 8);
  program[310] = BPF_INSN(0x57, 2, 0, 0, 16711680);
  program[311] = BPF_INSN(0xbf, 4, 1, 0, 0);
  program[312] = BPF_INSN(0x67, 4, 0, 0, 24);
  program[313] = BPF_INSN(0x67, 4, 0, 0, 32);
  program[314] = BPF_INSN(0x77, 4, 0, 0, 32);
  program[315] = BPF_INSN(0x4f, 4, 2, 0, 0);
  program[316] = BPF_INSN(0x18, 2, 0, 0, 1919950905);
  program[317] = BPF_INSN(0x00, 0, 0, 0, 976363638);
  program[318] = BPF_INSN(0x7b, 10, 2, -56, 0);
  program[319] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[320] = BPF_INSN(0x77, 2, 0, 0, 8);
  program[321] = BPF_INSN(0xbf, 3, 2, 0, 0);
  program[322] = BPF_INSN(0x57, 3, 0, 0, 65280);
  program[323] = BPF_INSN(0x4f, 4, 3, 0, 0);
  program[324] = BPF_INSN(0xbf, 5, 1, 0, 0);
  program[325] = BPF_INSN(0x77, 5, 0, 0, 40);
  program[326] = BPF_INSN(0x57, 5, 0, 0, 65280);
  program[327] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[328] = BPF_INSN(0x77, 3, 0, 0, 56);
  program[329] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[330] = BPF_INSN(0x77, 1, 0, 0, 24);
  program[331] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[332] = BPF_INSN(0x57, 3, 0, 0, 16711680);
  program[333] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[334] = BPF_INSN(0x5f, 2, 7, 0, 0);
  program[335] = BPF_INSN(0x4f, 5, 2, 0, 0);
  program[336] = BPF_INSN(0x57, 1, 0, 0, 255);
  program[337] = BPF_INSN(0x4f, 4, 1, 0, 0);
  program[338] = BPF_INSN(0x7b, 10, 9, -48, 0);
  program[339] = BPF_INSN(0x7b, 10, 8, -64, 0);
  program[340] = BPF_INSN(0x79, 3, 10, -8, 0);
  program[341] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[342] = BPF_INSN(0x07, 1, 0, 0, -64);
  program[343] = BPF_INSN(0xb7, 2, 0, 0, 24);
  program[344] = BPF_INSN(0x85, 0, 0, 0, 6);
  program[345] = BPF_INSN(0x79, 3, 10, -72, 0);
  program[346] = BPF_INSN(0x07, 3, 0, 0, 24);
  program[347] = BPF_INSN(0xbf, 1, 6, 0, 0);
  program[348] = BPF_INSN(0xb7, 2, 0, 0, 8);
  program[349] = BPF_INSN(0x85, 0, 0, 0, 4);
  program[350] = BPF_INSN(0x7b, 10, 9, -48, 0);
  program[351] = BPF_INSN(0x18, 1, 0, 0, 1919950905);
  program[352] = BPF_INSN(0x00, 0, 0, 0, 976429174);
  program[353] = BPF_INSN(0x7b, 10, 1, -56, 0);
  program[354] = BPF_INSN(0x7b, 10, 8, -64, 0);
  program[355] = BPF_INSN(0x79, 1, 10, -40, 0);
  program[356] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[357] = BPF_INSN(0x67, 2, 0, 0, 8);
  program[358] = BPF_INSN(0x57, 2, 0, 0, 16711680);
  program[359] = BPF_INSN(0xbf, 4, 1, 0, 0);
  program[360] = BPF_INSN(0x67, 4, 0, 0, 24);
  program[361] = BPF_INSN(0x67, 4, 0, 0, 32);
  program[362] = BPF_INSN(0x77, 4, 0, 0, 32);
  program[363] = BPF_INSN(0x4f, 4, 2, 0, 0);
  program[364] = BPF_INSN(0xbf, 5, 1, 0, 0);
  program[365] = BPF_INSN(0x77, 5, 0, 0, 40);
  program[366] = BPF_INSN(0x57, 5, 0, 0, 65280);
  program[367] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[368] = BPF_INSN(0x77, 2, 0, 0, 56);
  program[369] = BPF_INSN(0x4f, 5, 2, 0, 0);
  program[370] = BPF_INSN(0xbf, 2, 1, 0, 0);
  program[371] = BPF_INSN(0x77, 2, 0, 0, 24);
  program[372] = BPF_INSN(0xbf, 3, 2, 0, 0);
  program[373] = BPF_INSN(0x57, 3, 0, 0, 16711680);
  program[374] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[375] = BPF_INSN(0x77, 1, 0, 0, 8);
  program[376] = BPF_INSN(0xbf, 3, 1, 0, 0);
  program[377] = BPF_INSN(0x5f, 3, 7, 0, 0);
  program[378] = BPF_INSN(0x4f, 5, 3, 0, 0);
  program[379] = BPF_INSN(0x57, 1, 0, 0, 65280);
  program[380] = BPF_INSN(0x4f, 4, 1, 0, 0);
  program[381] = BPF_INSN(0x57, 2, 0, 0, 255);
  program[382] = BPF_INSN(0x4f, 4, 2, 0, 0);
  program[383] = BPF_INSN(0x79, 3, 10, -8, 0);
  program[384] = BPF_INSN(0xbf, 1, 10, 0, 0);
  program[385] = BPF_INSN(0x07, 1, 0, 0, -64);
  program[386] = BPF_INSN(0xb7, 2, 0, 0, 24);
  program[387] = BPF_INSN(0x85, 0, 0, 0, 6);
  program[388] = BPF_INSN(0xb7, 0, 0, 0, 0);
  program[389] = BPF_INSN(0x95, 0, 0, 0, 0);
  union bpf_attr* ret = calloc(1, sizeof(union bpf_attr));
  ret->prog_type = BPF_PROG_TYPE_KPROBE;
  ret->insns = (unsigned long)program;
  ret->insn_cnt = 390;
  ret->log_buf = (unsigned long)log_buf;
  ret->log_size = log_buf_size;
  ret->log_level = log_level;
  ret->license = (unsigned long)license;
  return ret;
}

union bpf_attr map_pkey_addr_by_tid = {
    .map_type = 1,
    .key_size = 8,
    .value_size = 8,
    .max_entries = 10240,
    .map_flags = 0,
};
